{"ast":null,"code":"import _toConsumableArray from\"D:/map/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"D:/map/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Button,Modal,Form,Input,message}from'antd';import L from'leaflet';import'leaflet/dist/leaflet.css';import markerIconUrl from'./marker.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Map=function Map(){// Состояние переменных\nvar _useState=useState([// Исходные маркеры\n{name:'ТЦ Горизонт',coordinates:[47.259301,39.719791]},{name:'ИВТиПТ',coordinates:[47.218953,39.627433]},{name:'Библиотека',coordinates:[47.228379,39.726662]},{name:'Правительство Ростовской области',coordinates:[47.220835,39.720871]},{name:'Собор Пресвятой Богородицы',coordinates:[47.217253,39.712026]}]),_useState2=_slicedToArray(_useState,2),markers=_useState2[0],setMarkers=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isModalVisible=_useState4[0],setIsModalVisible=_useState4[1];useEffect(function(){// Загрузка маркеров из localStorage или использование исходных маркеров\nvar storedMarkers=JSON.parse(localStorage.getItem('markers'))||markers;setMarkers(storedMarkers);// Инициализация карты Leaflet\nvar map=L.map('map').setView([47.2357,39.7015],12);// Добавление слоя тайлов OpenStreetMap\nL.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'Map data &copy; OpenStreetMap contributors',maxZoom:20}).addTo(map);// Создание пользовательской иконки маркера\nvar markerIcon=L.icon({iconUrl:markerIconUrl,iconSize:[32,40]});// Добавление маркеров на карту\nstoredMarkers.forEach(function(markerData){var name=markerData.name,coordinates=markerData.coordinates;var marker=L.marker(coordinates,{icon:markerIcon}).addTo(map);marker.bindPopup(name);});// Функция очистки для удаления карты при размонтировании компонента\nreturn function(){map.remove();};},[markers]);var handleMarkerFormSubmit=function handleMarkerFormSubmit(values){var latitude=parseFloat(values.latitude);var longitude=parseFloat(values.longitude);if(isNaN(latitude)||isNaN(longitude)){// Отображение сообщения об ошибке при неверных координатах\nmessage.error('Неверные координаты. Пожалуйста, введите числовые значения для широты и долготы.');return;}// Создание нового объекта маркера\nvar newMarker={name:values.name,coordinates:[latitude,longitude]};// Обновление состояния маркеров и сохранение в localStorage\nvar updatedMarkers=[].concat(_toConsumableArray(markers),[newMarker]);localStorage.setItem('markers',JSON.stringify(updatedMarkers));setMarkers(updatedMarkers);// Скрытие модального окна после добавления маркера\nsetIsModalVisible(false);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{id:\"map\",style:{width:'100%',height:'90vh'}}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',marginTop:'20px'},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:function onClick(){return setIsModalVisible(true);},children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043E\\u0431\\u044A\\u0435\\u043A\\u0442\"})}),/*#__PURE__*/_jsx(Modal,{title:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043E\\u0431\\u044A\\u0435\\u043A\\u0442\",open:isModalVisible,onCancel:function onCancel(){return setIsModalVisible(false);},footer:null,children:/*#__PURE__*/_jsxs(Form,{onFinish:handleMarkerFormSubmit,children:[/*#__PURE__*/_jsx(Form.Item,{label:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\",name:\"name\",rules:[{required:true,message:'Введите название'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u0428\\u0438\\u0440\\u043E\\u0442\\u0430\",name:\"latitude\",rules:[{required:true,message:'Введите широту'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{label:\"\\u0414\\u043E\\u043B\\u0433\\u043E\\u0442\\u0430\",name:\"longitude\",rules:[{required:true,message:'Введите долготу'}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"})})]})})]});};export default Map;","map":{"version":3,"names":["React","useState","useEffect","Button","Modal","Form","Input","message","L","markerIconUrl","jsx","_jsx","jsxs","_jsxs","Map","_useState","name","coordinates","_useState2","_slicedToArray","markers","setMarkers","_useState3","_useState4","isModalVisible","setIsModalVisible","storedMarkers","JSON","parse","localStorage","getItem","map","setView","tileLayer","attribution","maxZoom","addTo","markerIcon","icon","iconUrl","iconSize","forEach","markerData","marker","bindPopup","remove","handleMarkerFormSubmit","values","latitude","parseFloat","longitude","isNaN","error","newMarker","updatedMarkers","concat","_toConsumableArray","setItem","stringify","children","id","style","width","height","display","justifyContent","marginTop","type","onClick","title","open","onCancel","footer","onFinish","Item","label","rules","required","htmlType"],"sources":["D:/map/src/components/Map.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Button, Modal, Form, Input, message } from 'antd';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport markerIconUrl from './marker.png';\n\nconst Map = () => {\n  // Состояние переменных\n  const [markers, setMarkers] = useState([\n    // Исходные маркеры\n    {\n      name: 'ТЦ Горизонт',\n      coordinates: [47.259301, 39.719791],\n    },\n    {\n      name: 'ИВТиПТ',\n      coordinates: [47.218953, 39.627433],\n    },\n    {\n      name: 'Библиотека',\n      coordinates: [47.228379, 39.726662],\n    },\n    {\n      name: 'Правительство Ростовской области',\n      coordinates: [47.220835, 39.720871],\n    },\n    {\n      name: 'Собор Пресвятой Богородицы',\n      coordinates: [47.217253, 39.712026],\n    },\n  ]);\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  useEffect(() => {\n    // Загрузка маркеров из localStorage или использование исходных маркеров\n    const storedMarkers = JSON.parse(localStorage.getItem('markers')) || markers;\n    setMarkers(storedMarkers);\n\n    // Инициализация карты Leaflet\n    const map = L.map('map').setView([47.2357, 39.7015], 12);\n\n    // Добавление слоя тайлов OpenStreetMap\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: 'Map data &copy; OpenStreetMap contributors',\n      maxZoom: 20,\n    }).addTo(map);\n\n    // Создание пользовательской иконки маркера\n    const markerIcon = L.icon({\n      iconUrl: markerIconUrl,\n      iconSize: [32, 40],\n    });\n\n    // Добавление маркеров на карту\n    storedMarkers.forEach(markerData => {\n      const { name, coordinates } = markerData;\n      const marker = L.marker(coordinates, { icon: markerIcon }).addTo(map);\n      marker.bindPopup(name);\n    });\n\n    // Функция очистки для удаления карты при размонтировании компонента\n    return () => {\n      map.remove();\n    };\n  }, [markers]);\n\n\n  const handleMarkerFormSubmit = values => {\n    const latitude = parseFloat(values.latitude);\n    const longitude = parseFloat(values.longitude);\n\n    if (isNaN(latitude) || isNaN(longitude)) {\n      // Отображение сообщения об ошибке при неверных координатах\n      message.error('Неверные координаты. Пожалуйста, введите числовые значения для широты и долготы.');\n      return;\n    }\n\n    // Создание нового объекта маркера\n    const newMarker = {\n      name: values.name,\n      coordinates: [latitude, longitude],\n    };\n\n    // Обновление состояния маркеров и сохранение в localStorage\n    const updatedMarkers = [...markers, newMarker];\n    localStorage.setItem('markers', JSON.stringify(updatedMarkers));\n    setMarkers(updatedMarkers);\n\n    // Скрытие модального окна после добавления маркера\n    setIsModalVisible(false);\n  };\n\n  return (\n    <div>\n      <div id=\"map\" style={{ width: '100%', height: '90vh' }} />\n\n      <div style={{ display: 'flex', justifyContent: 'center', marginTop: '20px' }}>\n        <Button type=\"primary\" onClick={() => setIsModalVisible(true)}>Добавить объект</Button>\n      </div>\n\n      <Modal\n        title=\"Добавить объект\"\n        open={isModalVisible}\n        onCancel={() => setIsModalVisible(false)}\n        footer={null}\n      >\n        <Form onFinish={handleMarkerFormSubmit}>\n          <Form.Item label=\"Название\" name=\"name\" rules={[{ required: true, message: 'Введите название' }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item label=\"Широта\" name=\"latitude\" rules={[{ required: true, message: 'Введите широту' }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item label=\"Долгота\" name=\"longitude\" rules={[{ required: true, message: 'Введите долготу' }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item>\n            <Button type=\"primary\" htmlType=\"submit\">Добавить</Button>\n          </Form.Item>\n        </Form>\n      </Modal>\n    </div>\n  );\n};\n\nexport default Map;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}